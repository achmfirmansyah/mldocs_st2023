
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Preparing Satellite Imagery &#8212; ML-Docs for Indonesian Potential Agricultural Map</title>
    
  <link href="../_static/css/theme.css" rel="stylesheet">
  <link href="../_static/css/index.ff1ffe594081f20da1ef19478df9384b.css" rel="stylesheet">

    
  <link rel="stylesheet"
    href="../_static/vendor/fontawesome/5.13.0/css/all.min.css">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../_static/vendor/fontawesome/5.13.0/webfonts/fa-solid-900.woff2">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../_static/vendor/fontawesome/5.13.0/webfonts/fa-brands-400.woff2">

    
      

    
    <link rel="stylesheet" type="text/css" href="../_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-book-theme.css?digest=c3fdc42140077d1ad13ad2f1588a4309" />
    <link rel="stylesheet" type="text/css" href="../_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/mystnb.css" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="../_static/panels-main.c949a650a448cc0ae9fd3441c0e17fb0.css" />
    <link rel="stylesheet" type="text/css" href="../_static/panels-variables.06eb56fa6e07937060861dad626602ad.css" />
    
  <link rel="preload" as="script" href="../_static/js/index.be7d3bbb2ef33a8344ce.js">

    <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
    <script src="../_static/jquery.js"></script>
    <script src="../_static/underscore.js"></script>
    <script src="../_static/doctools.js"></script>
    <script src="../_static/togglebutton.js"></script>
    <script src="../_static/clipboard.min.js"></script>
    <script src="../_static/copybutton.js"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown, .tag_hide_input div.cell_input, .tag_hide-input div.cell_input, .tag_hide_output div.cell_output, .tag_hide-output div.cell_output, .tag_hide_cell.cell, .tag_hide-cell.cell';</script>
    <script src="../_static/sphinx-book-theme.d59cb220de22ca1c485ebbdc042f0030.js"></script>
    <script async="async" src="https://unpkg.com/thebe@0.5.1/lib/index.js"></script>
    <script>
        const thebe_selector = ".thebe"
        const thebe_selector_input = "pre"
        const thebe_selector_output = ".output"
    </script>
    <script async="async" src="../_static/sphinx-thebe.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Segmentation Data from Satellite Imagery" href="segmen.html" />
    <link rel="prev" title="Preparing Sample Area for Data Collection" href="intro_sample.html" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="docsearch:language" content="None">
    

    <!-- Google Analytics -->
    
  </head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="80">
    
    <div class="container-fluid" id="banner"></div>

    

    <div class="container-xl">
      <div class="row">
          
<div class="col-12 col-md-3 bd-sidebar site-navigation show" id="site-navigation">
    
        <div class="navbar-brand-box">
    <a class="navbar-brand text-wrap" href="../index.html">
      
        <!-- `logo` is deprecated in Sphinx 4.0, so remove this when we stop supporting 3 -->
        
      
      
      <img src="../_static/g1894.png" class="logo" alt="logo">
      
      
      <h1 class="site-logo" id="site-title">ML-Docs for Indonesian Potential Agricultural Map</h1>
      
    </a>
</div><form class="bd-search d-flex align-items-center" action="../search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search this book..." aria-label="Search this book..." autocomplete="off" >
</form><nav class="bd-links" id="bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item active">
        <ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../intro.html">
   Introduction
  </a>
 </li>
</ul>
<ul class="current nav bd-sidenav">
 <li class="toctree-l1 current active has-children">
  <a class="reference internal" href="intro_sample.html">
   Preparing Sample Area for Data Collection
  </a>
  <input checked="" class="toctree-checkbox" id="toctree-checkbox-1" name="toctree-checkbox-1" type="checkbox"/>
  <label for="toctree-checkbox-1">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul class="current">
   <li class="toctree-l2 current active">
    <a class="current reference internal" href="#">
     Preparing Satellite Imagery
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="segmen.html">
     Segmentation Data from Satellite Imagery
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="sampling.html">
     Choosing Clumps/Segment as Sample Locations
    </a>
   </li>
  </ul>
 </li>
</ul>

    </div>
</nav> <!-- To handle the deprecated key -->

<div class="navbar_extra_footer">
  Powered by <a href="https://jupyterbook.org">Jupyter Book</a>
</div>

</div>


          


          
<main class="col py-md-3 pl-md-4 bd-content overflow-auto" role="main">
    
    <div class="topbar container-xl fixed-top">
    <div class="topbar-contents row">
        <div class="col-12 col-md-3 bd-topbar-whitespace site-navigation show"></div>
        <div class="col pl-md-4 topbar-main">
            
            <button id="navbar-toggler" class="navbar-toggler ml-0" type="button" data-toggle="collapse"
                data-toggle="tooltip" data-placement="bottom" data-target=".site-navigation" aria-controls="navbar-menu"
                aria-expanded="true" aria-label="Toggle navigation" aria-controls="site-navigation"
                title="Toggle navigation" data-toggle="tooltip" data-placement="left">
                <i class="fas fa-bars"></i>
                <i class="fas fa-arrow-left"></i>
                <i class="fas fa-arrow-up"></i>
            </button>
            
            
<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn" aria-label="Download this page"><i
            class="fas fa-download"></i></button>

    <div class="dropdown-buttons">
        <!-- ipynb file if we had a myst markdown file -->
        
        <!-- Download raw file -->
        <a class="dropdown-buttons" href="../_sources/sampleData/prepro.md"><button type="button"
                class="btn btn-secondary topbarbtn" title="Download source file" data-toggle="tooltip"
                data-placement="left">.md</button></a>
        <!-- Download PDF via print -->
        <button type="button" id="download-print" class="btn btn-secondary topbarbtn" title="Print to PDF"
                onclick="printPdf(this)" data-toggle="tooltip" data-placement="left">.pdf</button>
    </div>
</div>

            <!-- Source interaction buttons -->

<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn"
        aria-label="Connect with source repository"><i class="fab fa-github"></i></button>
    <div class="dropdown-buttons sourcebuttons">
        <a class="repository-button"
            href="https://github.com/achmfirmansyah/mldocs_st2023"><button type="button" class="btn btn-secondary topbarbtn"
                data-toggle="tooltip" data-placement="left" title="Source repository"><i
                    class="fab fa-github"></i>repository</button></a>
        <a class="issues-button"
            href="https://github.com/achmfirmansyah/mldocs_st2023/issues/new?title=Issue%20on%20page%20%2FsampleData/prepro.html&body=Your%20issue%20content%20here."><button
                type="button" class="btn btn-secondary topbarbtn" data-toggle="tooltip" data-placement="left"
                title="Open an issue"><i class="fas fa-lightbulb"></i>open issue</button></a>
        
    </div>
</div>

            <!-- Full screen (wrap in <a> to have style consistency -->

<a class="full-screen-button"><button type="button" class="btn btn-secondary topbarbtn" data-toggle="tooltip"
        data-placement="bottom" onclick="toggleFullScreen()" aria-label="Fullscreen mode"
        title="Fullscreen mode"><i
            class="fas fa-expand"></i></button></a>

            <!-- Launch buttons -->

        </div>

        <!-- Table of contents -->
        <div class="d-none d-md-block col-md-2 bd-toc show noprint">
            
            <div class="tocsection onthispage pt-5 pb-3">
                <i class="fas fa-list"></i> Contents
            </div>
            <nav id="bd-toc-nav" aria-label="Page">
                <ul class="visible nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#merge-spot-6-7">
   1. Merge SPOT 6/7
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#warp-images">
   2. Warp Images
  </a>
 </li>
</ul>

            </nav>
        </div>
    </div>
</div>
    <div id="main-content" class="row">
        <div class="col-12 col-md-9 pl-md-3 pr-md-0">
            <!-- Table of contents that is only displayed when printing the page -->
            <div id="jb-print-docs-body" class="onlyprint">
                <h1>Preparing Satellite Imagery</h1>
                <!-- Table of contents -->
                <div id="print-main-content">
                    <div id="jb-print-toc">
                        
                        <div>
                            <h2> Contents </h2>
                        </div>
                        <nav aria-label="Page">
                            <ul class="visible nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#merge-spot-6-7">
   1. Merge SPOT 6/7
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#warp-images">
   2. Warp Images
  </a>
 </li>
</ul>

                        </nav>
                    </div>
                </div>
            </div>
            
              <div>
                
  <div class="section" id="preparing-satellite-imagery">
<h1>Preparing Satellite Imagery<a class="headerlink" href="#preparing-satellite-imagery" title="Permalink to this headline">¶</a></h1>
<p>In this section, we will focus on preparing SPOT 6/7 data to become ready-to-used data for segmentation.  The preparing process consist of 3 steps:
merging data from several periods, warp/slice imagery for each grid (10 km x 10 km), and patching imagery for boundary area</p>
<p><img alt="" src="../_images/prepro_1.png" /></p>
<div class="section" id="merge-spot-6-7">
<h2>1. Merge SPOT 6/7<a class="headerlink" href="#merge-spot-6-7" title="Permalink to this headline">¶</a></h2>
<p>The SPOT data that we acquired from BRIN-LAPAN are split into each province. Basically, every province have 2 images (1 image composite of Jan-Dec 2019 and 1 image composite of Jan-Jun 2020). But there are several provinces that limited on one time period (either 2019-composite or 2020-composite).
We will utilize those two periods to fill the coverage gap, if there are two periods composite imagery.</p>
<p>The image below will explain the main idea of first step.
<img alt="" src="../_images/prepro_3.png" /></p>
<p>As expected, after merging two images, there will be visible contrast of two images.
<img alt="" src="../_images/Prepro_4.png" /></p>
<p>Despite that, the contrary is acceptable in purpose of escalate the coverages and take the recent acquisition.</p>
<p>To perform this step, we use this code.</p>
<div class="highlight-commandline notranslate"><div class="highlight"><pre><span></span>#input path
ds_2019=r&#39;path/to/images2019.ecw&#39;
ds_2020=r&#39;path/to/images2020.ecw&#39;

#output path
path_D=&#39;path/to/ouput.vrt&#39;

#syntax
from osgeo import gdal
ds=gdal.BuildVRT(path_D,[ds_2019,ds_2020])
ds=None
</pre></div>
</div>
<p>The output of this code will be VRT file. VRT file is preferable due to the advantages in small file size. It can be achieved because the file store the data virtually compared physically. In contrary, this file is used for non-complicated further operation. More information about this extension referred to this <a href='https://gdal.org/drivers/raster/vrt.html'>link</a>.</p>
</div>
<div class="section" id="warp-images">
<h2>2. Warp Images<a class="headerlink" href="#warp-images" title="Permalink to this headline">¶</a></h2>
<p>After building the merged file we clip the result into small grid 10km-10km for each province (this step is used <code class="docutils literal notranslate"><span class="pre">gdal_warp</span></code> function). We use this approach to enlighten the workloads of next procedure (Segmentation process). The grid file are prepared independently aside this procedure. Furthermore, the grid is also used in Machine Learning project conducted in the 2021.</p>
<p>The images below will describe the process.</p>
<p>To perform this step, this code will be used. In addition, this code also run in the Python Console inside QGIS.</p>
<div class="highlight-commandline notranslate"><div class="highlight"><pre><span></span>from qgis.core import *
import qgis.utils
from qgis.core import QgsVectorLayer
import os
os.chdir(&#39;D:&#39;)
path_D=r&#39;path/to/ouput.vrt&#39;
from osgeo import gdal

#The main code for clipping/warp
def clip_spot(crop_,name_,prov):
    ds=gdal.Warp(&#39;patched_&#39;+name_+&#39;.tif&#39;,path_D,
            outputBounds=crop_,warpOptions=&#39;CUTLINE_ALL_TOUCHED=TRUE&#39;)
    ds=None

#The grid provinces
data=QgsVectorLayer(&#39;path/to/grid_prov.gpkg&#39;,&#39;data_rep&#39;,&#39;ogr&#39;)
features_data=data.getFeatures()

#Iterative function
for i in features_data:
    bottom_=i[&#39;bottom&#39;]
    top_=i[&#39;top&#39;]
    left_=i[&#39;left&#39;]
    right_=i[&#39;right&#39;]
    nama_=i[&#39;ID_GRID&#39;]
    cropbound=[left_,bottom_,right_,top_]
    clip_spot(cropbound,nama_,&#39;ID_PROV&#39;)
    print(i)
</pre></div>
</div>
<p>The output of this code is tif file with size 10km-10km represent the grid. If the SPOT file have 1000 grid, the result of this code would be also 1000 tif file.</p>
<p>###3. Patched Imagery in Boundary Area</p>
<p>After clipping/warp image into 10km-10km size, we will continue patch the tif image, which located in boundary of province. For example, grid with ID-0024 is found in Aceh and North Sumatera, the result of previous step would two image with same grid. Therefore, we need to patch those tiff into one file for making the next procedure easier.
The image below can be used to describe the process.</p>
<p>To perform this step, we will use this code inside the Python Console in QGIS.</p>
<div class="highlight-commandline notranslate"><div class="highlight"><pre><span></span>from osgeo import gdal
import os
import shutil
from glob import glob

#To get the list of grid tif file
data_tif=glob(&#39;D:\*.tif&#39;)
id_split-set([i[11:] for i in data_tif])

for i in id_split:
    data_splitted=[j for j in data_tif if j[11:]==i]
    if len(data_splitted)&gt;1:
        vrt=i.replace(&#39;tif&#39;,&#39;vrt&#39;)
        gdal.buildVRT(vrt,sorted(data_splitted,reverse=False))
        gdal.Translate(&#39;patched_&#39;+i,vrt)
    else:
        shutil(data_splitted[0],&#39;patched_&#39;+i)
</pre></div>
</div>
</div>
</div>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            kernelName: "python3",
            path: "./sampleData"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

              </div>
              
            
                <!-- Previous / next buttons -->
<div class='prev-next-area'> 
    <a class='left-prev' id="prev-link" href="intro_sample.html" title="previous page">
        <i class="fas fa-angle-left"></i>
        <div class="prev-next-info">
            <p class="prev-next-subtitle">previous</p>
            <p class="prev-next-title">Preparing Sample Area for Data Collection</p>
        </div>
    </a>
    <a class='right-next' id="next-link" href="segmen.html" title="next page">
    <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">Segmentation Data from Satellite Imagery</p>
    </div>
    <i class="fas fa-angle-right"></i>
    </a>
</div>
            
        </div>
    </div>
    <footer class="footer">
  <p>
    
      By Statistics Indonesia - BPS<br/>
    
        &copy; Copyright 2021.<br/>
  </p>
</footer>
</main>


      </div>
    </div>
  
  <script src="../_static/js/index.be7d3bbb2ef33a8344ce.js"></script>

  </body>
</html>